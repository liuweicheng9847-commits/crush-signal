<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¿ƒåŠ¨ä¿¡å·æ•è·å™¨ï¼šTAå¯¹ä½ å¿ƒåŠ¨äº†å—ï¼Ÿ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ============ V6.0 è§†è§‰ç³»ç»Ÿï¼šé¦™èŠ‹ç´« Â· å¿ƒåŠ¨ä¿¡å·ç‰ˆ ============ */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        :root {
            --primary: #8483f0; /* é¦™èŠ‹ç´« */
            --primary-dark: #6c5ce7;
            --bg: #f4f5f7;
            --text-main: #2d3436;
            --text-sub: #636e72;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            margin: 0; padding: 0; color: var(--text-main);
            min-height: 100vh;
            display: flex; justify-content: center;
        }

        .container {
            width: 100%; max-width: 420px; 
            background: #fff; min-height: 100vh;
            display: flex; flex-direction: column;
            box-shadow: 0 0 20px rgba(0,0,0,0.03);
            position: relative;
        }

        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* é€šç”¨æŒ‰é’® */
        .btn-main {
            background: var(--primary); color: white; border: none;
            width: 100%; padding: 16px; border-radius: 50px;
            font-size: 16px; font-weight: bold; cursor: pointer;
            box-shadow: 0 8px 20px rgba(132, 131, 240, 0.3);
            transition: transform 0.1s;
        }
        .btn-main:active { transform: scale(0.96); }

        /* === 1. é¦–é¡µ === */
        #page-landing { padding: 60px 30px; text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .hero-icon { font-size: 70px; margin-bottom: 20px; animation: float 3s infinite ease-in-out; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        
        .hero-title { font-size: 26px; font-weight: 900; color: #2d3436; margin-bottom: 10px; line-height: 1.3; }
        .hero-sub { font-size: 14px; color: var(--text-sub); margin-bottom: 40px; line-height: 1.6; }
        
        .code-input {
            background: #f1f2f6; border: 2px solid transparent;
            padding: 15px; border-radius: 16px; width: 100%;
            text-align: center; font-size: 18px; outline: none; letter-spacing: 2px;
            margin-bottom: 20px; font-weight: bold;
        }
        .code-input:focus { border-color: var(--primary); background: #fff; }

        /* === 2. é€‰æ‹©é¡µ (æ€§åˆ«/çŠ¶æ€) === */
        .select-page { padding: 40px 25px; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .select-header { font-size: 20px; font-weight: bold; text-align: center; margin-bottom: 30px; }
        
        .select-card {
            background: #fff; border: 2px solid #f1f2f6; padding: 25px;
            border-radius: 20px; margin-bottom: 15px; cursor: pointer;
            display: flex; align-items: center; justify-content: space-between;
            transition: all 0.2s;
        }
        .select-card:active { border-color: var(--primary); background: #f8f7fc; }
        .select-icon { font-size: 34px; margin-right: 15px; }
        .select-info { flex: 1; text-align: left; }
        .select-label { font-size: 16px; font-weight: bold; color: #2d3436; }
        .select-desc { font-size: 12px; color: #b2bec3; margin-top: 4px; }

        /* === 3. ç­”é¢˜é¡µ === */
        #page-quiz { display: flex; flex-direction: column; height: 100vh; }
        .quiz-header { padding: 20px 25px 10px; background: #fff; }
        .progress-track { height: 6px; background: #f1f2f6; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
        .quiz-meta { display: flex; justify-content: space-between; margin-top: 10px; font-size: 12px; color: #b2bec3; font-weight: bold; }
        
        .quiz-body { flex: 1; padding: 20px 25px; overflow-y: auto; }
        .question-text { font-size: 19px; font-weight: 800; color: #2d3436; line-height: 1.5; margin-bottom: 25px; }
        
        .option-btn {
            background: #fff; border: 1.5px solid #e0e0e0; padding: 16px 20px;
            border-radius: 16px; margin-bottom: 12px; cursor: pointer;
            display: flex; align-items: center; transition: all 0.15s;
        }
        .option-btn:active { border-color: var(--primary); background: #f0efff; transform: scale(0.99); }
        .opt-idx { 
            width: 24px; height: 24px; background: #f1f2f6; color: var(--text-sub);
            border-radius: 50%; font-size: 12px; font-weight: bold;
            display: flex; align-items: center; justify-content: center; margin-right: 12px; flex-shrink: 0;
        }
        .option-btn:active .opt-idx { background: var(--primary); color: white; }
        .opt-content { font-size: 15px; color: #2d3436; font-weight: 500; }

        /* === 4. æ·±åº¦åˆ†æé¡µç‰¹æ•ˆ === */
        #page-analyzing {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; background: #f4f5f7; padding: 30px;
        }
        .scan-wrapper { position: relative; width: 180px; height: 180px; margin-bottom: 40px; }
        .pulse-circle {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            border: 2px solid var(--primary); border-radius: 50%; opacity: 0.6;
            animation: pulse 2s infinite;
        }
        .pulse-circle::after {
            content: ''; position: absolute;
            top: -10px; left: -10px; right: -10px; bottom: -10px;
            border: 1px solid var(--primary); border-radius: 50%;
            opacity: 0.3; animation: pulse 2s infinite 0.5s;
        }
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 0.4; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        .scan-grid {
            position: absolute; top: 15px; left: 15px; right: 15px; bottom: 15px;
            background: linear-gradient(rgba(132, 131, 240, 0.1) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(132, 131, 240, 0.1) 1px, transparent 1px);
            background-size: 10px 10px; border-radius: 50%;
            border: 1px dashed var(--primary); overflow: hidden;
            box-shadow: inset 0 0 20px rgba(132, 131, 240, 0.2);
        }
        .scan-line {
            width: 100%; height: 4px; background: #00b894;
            box-shadow: 0 0 10px #00b894; position: absolute; top: 0;
            animation: scanning 1.5s infinite linear;
        }
        @keyframes scanning {
            0% { top: -10%; opacity: 0; } 100% { top: 110%; opacity: 0; }
        }
        .status-box { text-align: left; width: 100%; max-width: 300px; }
        .status-title { font-size: 18px; font-weight: 900; color: #2d3436; margin-bottom: 15px; text-align: center; }
        .terminal-logs {
            font-family: "Courier New", Courier, monospace; font-size: 12px; color: var(--text-sub);
            line-height: 1.8; height: 80px; overflow: hidden; position: relative;
        }
        .log-item { display: block; opacity: 0; transform: translateY(10px); transition: all 0.3s; }
        .log-item.active { opacity: 1; transform: translateY(0); color: var(--primary-dark); font-weight: bold; }
        .log-item.old { opacity: 0.5; transform: translateY(-5px); }
        .analyzing-bar-bg { width: 100%; height: 4px; background: #e0e0e0; border-radius: 2px; margin-top: 20px; overflow: hidden; }
        .analyzing-bar-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.2s linear; }

        /* === 5. ç»“æœé¡µ === */
        #page-result { 
            background: var(--primary); padding: 20px; min-height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .result-poster {
            background: #fff; width: 100%; border-radius: 24px;
            padding: 30px 25px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2); position: relative;
        }
        .score-wrap { width: 110px; height: 110px; margin: 0 auto 20px; position: relative; display: flex; align-items: center; justify-content: center; }
        .score-val { font-size: 36px; font-weight: 900; color: var(--primary); z-index: 2; }
        .res-title { font-size: 22px; font-weight: 900; color: #2d3436; margin-bottom: 8px; }
        .res-tag { 
            display: inline-block; background: #f0efff; color: var(--primary); 
            padding: 4px 12px; border-radius: 8px; font-size: 12px; font-weight: bold; margin-bottom: 25px;
        }
        .res-box {
            background: #f8f9fa; border-radius: 12px; padding: 15px; text-align: left;
            margin-bottom: 20px; border-left: 4px solid var(--primary);
        }
        .res-label { font-size: 12px; color: #b2bec3; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
        .res-text { font-size: 14px; color: #2d3436; line-height: 1.6; text-align: justify; }
        
        .btn-save {
            background: #2d3436; color: white; border: none;
            width: 100%; padding: 14px; border-radius: 12px;
            font-size: 14px; font-weight: bold; margin-top: 10px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }

    </style>
</head>
<body>

<div class="container">
    
    <div id="page-landing" class="fade-in">
        <div class="hero-icon">ğŸ’“</div>
        <h1 class="hero-title">å¿ƒåŠ¨ä¿¡å·æ•è·å™¨</h1>
        <p class="hero-sub">æ•æ‰æš§æ˜§æœŸå¾®è¡¨æƒ…ä¸ä¸‹æ„è¯†ååº”<br>25é“é¢˜ Â· çœ‹çœ‹TAæ˜¯å¦ä¹Ÿåœ¨å·å·å–œæ¬¢ä½ </p>
        
        <input type="text" id="access-code" class="code-input" placeholder="è¯·è¾“å…¥è§£é”ç " autocomplete="off" autocorrect="off" autocapitalize="characters">
        <button class="btn-main" onclick="goToGender()">ç«‹å³æ£€æµ‹</button>
        <p style="font-size:12px; color:#b2bec3; margin-top:20px;">* å·²æœ‰ 32,401 äººå‚ä¸æµ‹è¯•</p>
    </div>

    <div id="page-gender" class="select-page hidden fade-in">
        <div class="select-header">ä½ çš„å¿ƒåŠ¨å¯¹è±¡æ˜¯ï¼Ÿ</div>
        
        <div class="select-card" onclick="selectGender('Him')">
            <div class="select-icon">ğŸ¦Š</div>
            <div class="select-info">
                <div class="select-label">ä»– (ç”·ç”Ÿ)</div>
                <div class="select-desc">è§£è¯»ä»–çš„æ½œæ„è¯†å¿ƒåŠ¨ä¿¡å·</div>
            </div>
        </div>

        <div class="select-card" onclick="selectGender('Her')">
            <div class="select-icon">ğŸ°</div>
            <div class="select-info">
                <div class="select-label">å¥¹ (å¥³ç”Ÿ)</div>
                <div class="select-desc">è¯»æ‡‚å¥¹è—ä¸ä½çš„å°å¿ƒæ€</div>
            </div>
        </div>
    </div>

    <div id="page-status" class="select-page hidden fade-in">
        <div class="select-header">ä½ ä»¬ç°åœ¨çš„çŠ¶æ€æ˜¯ï¼Ÿ</div>
        <div class="select-card" onclick="selectStatus('Crush')">
            <div class="select-icon">ğŸ­</div>
            <div class="select-info">
                <div class="select-label">å•å‘æš—æ‹ / ä¸Šå¤´ä¸­</div>
                <div class="select-desc">"æ˜¯æˆ‘è‡ªä½œå¤šæƒ…ï¼Œè¿˜æ˜¯åŒå‘å¥”èµ´ï¼Ÿ"</div>
            </div>
        </div>
        <div class="select-card" onclick="selectStatus('Game')">
            <div class="select-icon">ğŸ”®</div>
            <div class="select-info">
                <div class="select-label">æé™æ‹‰æ‰¯ / å¿½å†·å¿½çƒ­</div>
                <div class="select-desc">"ä»–æ˜¯åœ¨å…»é±¼ï¼Œè¿˜æ˜¯çœŸçš„å¿™ï¼Ÿ"</div>
            </div>
        </div>
    </div>

    <div id="page-quiz" class="hidden">
        <div class="quiz-header">
            <div class="progress-track"><div class="progress-fill" id="progress"></div></div>
            <div class="quiz-meta">
                <span>æ½œæ„è¯†è§£ç ä¸­...</span>
                <span><span id="q-curr">1</span> / <span id="q-total">25</span></span>
            </div>
        </div>
        <div class="quiz-body fade-in" id="quiz-box">
            <div class="question-text" id="q-text">é¢˜ç›®åŠ è½½ä¸­...</div>
            <div id="options-box"></div>
        </div>
    </div>

    <div id="page-analyzing" class="hidden">
        <div class="scan-wrapper">
            <div class="pulse-circle"></div>
            <div class="scan-grid">
                <div style="font-size:50px; text-align:center; line-height:150px; opacity:0.2;">ğŸ§ </div>
                <div class="scan-line"></div>
            </div>
        </div>

        <div class="status-box">
            <div class="status-title" id="analyze-main-text">ç³»ç»Ÿæ¥å…¥ä¸­...</div>
            <div class="terminal-logs" id="log-container"></div>
            <div class="analyzing-bar-bg">
                <div class="analyzing-bar-fill" id="analyze-progress"></div>
            </div>
        </div>
        
        <p style="font-size:12px; color:#b2bec3; margin-top:30px; letter-spacing:1px;">
            CONNECTING TO SUBCONSCIOUS...
        </p>
    </div>

    <div id="page-result" class="hidden fade-in">
        <div class="result-poster">
            <div style="font-size:10px; color:#b2bec3; margin-bottom:15px; letter-spacing:2px;">HEART SIGNAL REPORT</div>
            
            <div class="score-wrap">
                <canvas id="scoreChart" width="110" height="110" style="position:absolute; top:0; left:0;"></canvas>
                <div class="score-val" id="final-score">--</div>
            </div>

            <div class="res-title" id="res-title">åˆ†æä¸­...</div>
            <div class="res-tag" id="res-tag">...</div>

            <div class="res-box">
                <div class="res-label">ğŸ§  æ½œæ„è¯†è§£ç </div>
                <div class="res-text" id="res-analysis"></div>
            </div>

            <div class="res-box" style="border-left-color: #fab1a0;">
                <div class="res-label">ğŸ’¡ ç ´å±€å»ºè®®</div>
                <div class="res-text" id="res-advice"></div>
            </div>

            <button class="btn-save" onclick="alert('è¯·ç›´æ¥æˆªå›¾ä¿å­˜æœ¬é¡µå“¦ ğŸ“¸')">
                <span>ğŸ“¸</span> æˆªå›¾ä¿å­˜è¯Šæ–­ä¹¦
            </button>
            <div style="margin-top:15px; font-size:13px; color:#b2bec3; cursor:pointer;" onclick="location.reload()">â†º è¿”å›é¦–é¡µé‡æµ‹</div>
        </div>
    </div>

</div>

<script>
    // ================== ç§˜é’¥åº“ ==================
    var VALID_CODES = [
        "HKUYLT", "AJSQLA", "AX4EFM", "PSB5CB", "6SLNK3", "Z422XU", "CPFTCN", "GY8YCB", "BJQP2Z", "K9N5R6", 
        "4B3GR7", "H4SX8X", "84L2EY", "F5254D", "L48UDF", "FXSVQP", "LY96UL", "FG6F6M", "8E4PFE", "4LZW86", 
        "ADMIN", "LOVE" 
    ];

    // ================== é¢˜åº“ (ä¿æŒåŸæ ·) ==================
    var questions = [
        { title: "1. ä¸€ç¾¤äººä¸€èµ·ç¬‘çš„æ—¶å€™ï¼ŒTAçš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ", options: [{ text: "ä¸‹æ„è¯†çœ‹å‘ä½ ï¼ˆè§†çº¿å¯»æ‰¾ï¼‰", score: 10 }, { text: "è§†çº¿æ‰«è¿‡å¤§å®¶ï¼Œä½†åœ¨ä½ èº«ä¸Šåœç•™è¾ƒä¹…", score: 8 }, { text: "å¶å°”çœ‹ä½ ä¸€çœ¼", score: 5 }, { text: "çœ‹åˆ«äººæˆ–ä½å¤´", score: 0 }] },
        { title: "2. å¦‚æœä½ ä»¬ä¸ç»æ„å¯¹è§†ï¼ŒTAçš„ååº”ï¼Ÿ", options: [{ text: "ç³å­”æ”¾å¤§ï¼Œæ…Œä¹±èº²é—ªï¼ˆç´§å¼ ï¼‰", score: 8 }, { text: "çœ¼ç¥é”å®šï¼Œå¾®ç¬‘ç€çœ‹ä½ ï¼ˆè‡ªä¿¡/åƒå®šä½ ï¼‰", score: 10 }, { text: "è‡ªç„¶ç§»å¼€ï¼Œåƒçœ‹è·¯äººä¸€æ ·", score: 0 }, { text: "ç¤¼è²Œåœ°ç‚¹å¤´ç¤ºæ„", score: 2 }] },
        { title: "3. èµ°è·¯æ—¶ï¼ŒTAé€šå¸¸èµ°åœ¨å“ªé‡Œï¼Ÿ", options: [{ text: "æ€»æ˜¯èµ°åœ¨å¤–ä¾§ï¼ˆé è¿‘è½¦æµçš„ä¸€ä¾§ï¼‰", score: 10 }, { text: "å’Œä½ å¹¶æ’ï¼Œå¶å°”ç¢°åˆ°è‚©è†€", score: 8 }, { text: "èµ°å¾—å¾ˆå¿«ï¼Œç»å¸¸æŠŠä½ ç”©åœ¨åé¢", score: 0 }, { text: "çœ‹æƒ…å†µï¼Œæ²¡æœ‰å›ºå®šä½ç½®", score: 3 }] },
        { title: "4. ååœ¨ä¸€èµ·æ—¶ï¼ŒTAçš„è†ç›–å’Œè„šå°–æœå‘ï¼Ÿ", options: [{ text: "å®Œå…¨æœå‘ä½ çš„æ–¹å‘ï¼ˆå¼€æ”¾å§¿æ€ï¼‰", score: 10 }, { text: "ä¸ŠåŠèº«è½¬å‘ä½ ï¼Œä½†è„šå°–æœå‘å‡ºå£", score: 4 }, { text: "äºŒéƒè…¿ç¿˜å‘è¿œç¦»ä½ çš„æ–¹å‘ï¼ˆé˜²å¾¡å§¿æ€ï¼‰", score: 0 }, { text: "ä¸­è§„ä¸­çŸ©ï¼Œæ²¡æœ‰æ˜æ˜¾å€¾å‘", score: 5 }] },
        { title: "5. å½“ä½ æ‹¿èµ·æ¯å­å–æ°´æ—¶ï¼ŒTAä¼šï¼Ÿ", options: [{ text: "å‡ ç§’é’Ÿå†…ä¹Ÿä¸‹æ„è¯†æ‹¿èµ·æ¯å­å–æ°´ï¼ˆé•œåƒæ•ˆåº”ï¼‰", score: 10 }, { text: "çœ‹ç€ä½ å–æ°´", score: 6 }, { text: "å®Œå…¨æ²¡æ³¨æ„", score: 0 }, { text: "ç»§ç»­ç©æ‰‹æœº", score: 0 }] },
        { title: "6. å½“ä½ è¯´â€œæˆ‘ç”Ÿç—…äº†/å¿ƒæƒ…ä¸å¥½â€æ—¶...", options: [{ text: "ç«‹åˆ»é—®ä½ åœ¨å“ª/è¦ä¸è¦é€è¯", score: 10 }, { text: "ä¸€ç›´é™ªèŠï¼Œæ—¶ä¸æ—¶ç¡®è®¤ä½ å¥½ç‚¹æ²¡", score: 8 }, { text: "å‘ä¸ªâ€œæ‘¸æ‘¸å¤´â€è¡¨æƒ…åŒ…å®Œäº‹", score: 2 }, { text: "å£å¤´å®‰æ…°å‡ å¥ï¼Œç„¶åè®²è‡ªå·±çš„äº‹", score: 0 }] },
        { title: "7. ä½ ä»¬èŠå¤©çš„ç»“å°¾é€šå¸¸æ˜¯ï¼Ÿ", options: [{ text: "TAæ€»æ˜¯å¼€å¯æ–°è¯é¢˜ï¼Œä¸æƒ³ç»“æŸ", score: 10 }, { text: "TAä¼šå¤šè¯´ä¸€å¥åºŸè¯ï¼Œè¯•å›¾æ‹–å»¶", score: 8 }, { text: "äº’é“æ™šå®‰ï¼Œå¾ˆæœ‰ä»ªå¼æ„Ÿ", score: 5 }, { text: "ä½ æƒ³ç»“æŸï¼ŒTAå°±ä¸å›äº†", score: 0 }] },
        { title: "8. çœ‹åˆ°ä½ çš„æœ‹å‹åœˆæ–°åŠ¨æ€ï¼ŒTAä¼šï¼Ÿ", options: [{ text: "ç§’èµï¼Œæˆ–ç§èŠè¯„è®ºç›¸å…³å†…å®¹", score: 10 }, { text: "åŸºæœ¬éƒ½ä¼šèµï¼Œè¯„è®ºä¹Ÿå¾ˆç”¨å¿ƒ", score: 8 }, { text: "å¶å°”ç‚¹èµ", score: 4 }, { text: "å¾ˆä¹…æ‰èµï¼Œæˆ–è€…è£…æ²¡çœ‹è§", score: 0 }] },
        { title: "9. ä¸€èµ·å‡ºå»ç©ä¹°å•çš„æƒ…å†µï¼Ÿ", options: [{ text: "ç²¾å¿ƒæŒ‘é€‰é¤å…ï¼Œä¸»åŠ¨æŠ¢ç€ä¹°å•", score: 10 }, { text: "è¿™æ¬¡TAä»˜ï¼Œä¸‹æ¬¡ä½ ä»˜ï¼ˆè½®æµï¼‰", score: 8 }, { text: "ä¸¥æ ¼AA", score: 2 }, { text: "ç­‰ç€ä½ ææ‰‹æœºï¼Œå®åœ¨ä¸è¡Œå†ä»˜", score: 0 }] },
        { title: "10. å¦‚æœä½ éšå£æè®®æƒ³å»æŸä¸ªåœ°æ–¹ï¼Ÿ", options: [{ text: "è®°å¾—å¾ˆæ¸…æ¥šï¼Œå¹¶è§„åˆ’å¥½å¸¦ä½ å»", score: 10 }, { text: "è®°åœ¨å¤‡å¿˜å½•é‡Œï¼Œä¹‹åæèµ·", score: 8 }, { text: "è¯´â€œä¸‹æ¬¡æœ‰æœºä¼šå»â€", score: 2 }, { text: "å¬è¿‡å°±å¿˜", score: 0 }] },
        { title: "11. TAä¼šæ¨¡ä»¿ä½ çš„è¡¨æƒ…åŒ…æˆ–å£å¤´ç¦…å—ï¼Ÿ", options: [{ text: "è¶Šæ¥è¶Šå¤šï¼ŒèŠå¤©é£æ ¼é€æ¸åŒåŒ–", score: 10 }, { text: "ä¼šå·ä½ çš„å›¾ï¼Œç”¨ä½ å¸¸ç”¨çš„è¯", score: 8 }, { text: "å¶å°”ç”¨ä¸€ä¸¤ä¸ª", score: 5 }, { text: "ä»ä¸ï¼Œç”šè‡³è§‰å¾—æ— èŠ", score: 0 }] },
        { title: "12. å½“ä½ æåˆ°å…¶ä»–çš„å¼‚æ€§æœ‹å‹æ—¶ï¼Ÿ", options: [{ text: "çªç„¶æ²‰é»˜ï¼Œæˆ–è€…è¡¨ç°å‡ºåƒé†‹/é˜´é˜³æ€ªæ°”", score: 10 }, { text: "å¼€å§‹æ‰“å¬é‚£ä¸ªäººæ˜¯è°", score: 8 }, { text: "è·Ÿç€ä¸€èµ·å…«å¦", score: 2 }, { text: "å®Œå…¨ä¸åœ¨æ„", score: 0 }] },
        { title: "13. æ™šä¸Šå‘æ¶ˆæ¯ç»™TAï¼Œé€šå¸¸å¤šä¹…å›ï¼Ÿ", options: [{ text: "åªè¦æ²¡ç¡å°±ä¼šç§’å›", score: 10 }, { text: "å¦‚æœé†’ç€ä¼šå›ï¼Œç¡äº†ç¬¬äºŒå¤©æ—©èµ·å›", score: 8 }, { text: "ç¬¬äºŒå¤©æ­£å¸¸å›å¤ï¼Œä¸å†·ä¸çƒ­", score: 2 }, { text: "å¾ˆä¹…æ‰å›ï¼Œæˆ–è€…ç»å¸¸ä¸å›", score: 0 }] },
        { title: "14. åœ¨TAçš„æœ‹å‹é¢å‰ï¼ŒTAä»‹ç»ä½ æ—¶ï¼Ÿ", options: [{ text: "æœ‰äº›è®¸ç´§å¼ ï¼Œä½†éƒ‘é‡å…¶äº‹åœ°ä»‹ç»", score: 10 }, { text: "çƒ­æƒ…å¤§æ–¹åœ°ä»‹ç»åå­—", score: 8 }, { text: "å«ç³Šå¸¦è¿‡ï¼Œæˆ–è€…å‡è£…ä¸ç†Ÿ", score: 0 }, { text: "æ²¡æœºä¼šè§åˆ°TAçš„æœ‹å‹", score: 0 }] },
        { title: "15. å›å¤æ¶ˆæ¯çš„å­—æ•°å’Œè¯­æ°”ï¼Ÿ", options: [{ text: "å°ä½œæ–‡ï¼Œç”Ÿæ€•ä½ è¯¯ä¼šï¼Œè§£é‡Šå¾—å¾ˆè¯¦ç»†", score: 10 }, { text: "ä¼šä¸»åŠ¨å»¶ä¼¸è¯é¢˜ï¼Œä¸è®©è¯æ‰åœ°ä¸Š", score: 8 }, { text: "ç®€çŸ­å›å¤ï¼Œä¸å¸¦è¯­æ°”è¯", score: 2 }, { text: "æƒœå­—å¦‚é‡‘ï¼Œâ€œå—¯â€â€œå“¦â€", score: 0 }] },
        { title: "16. ä½ ä»¬è§é¢æ—¶çš„æ‰“æ‰®ï¼Ÿ", options: [{ text: "æ˜æ˜¾ç²¾å¿ƒæ‰“æ‰®è¿‡ï¼ˆæ´—å¤´/å–·é¦™æ°´/æ­é…è¡£æœï¼‰", score: 10 }, { text: "æ¯”å¹³æ—¶ç¨å¾®æ•´æ´ä¸€ç‚¹", score: 6 }, { text: "å’Œå¹³æ—¶ä¸€æ ·ï¼Œå¾ˆéšæ„", score: 2 }, { text: "ä¸ä¿®è¾¹å¹…ï¼Œç”šè‡³æœ‰ç‚¹é‚‹é¢", score: 0 }] },
        { title: "17. å¦‚æœä½ ä»¬çš„çº¦ä¼šè¢«è¿«å–æ¶ˆï¼Ÿ", options: [{ text: "è¡¨ç°å‡ºæ˜æ˜¾å¤±æœ›ï¼Œå¹¶ç«‹åˆ»æ•²å®šä¸‹ä¸ªæ—¶é—´", score: 10 }, { text: "æœ‰ç‚¹é—æ†¾ï¼Œé—®ä½ ä»€ä¹ˆæ—¶å€™å†æœ‰ç©º", score: 8 }, { text: "â€œæ²¡äº‹ï¼Œä¸‹æ¬¡å†çº¦â€", score: 2 }, { text: "â€œé‚£åˆšå¥½ï¼Œæˆ‘åœ¨å®¶ä¼‘æ¯â€", score: 0 }] },
        { title: "18. TAä¼šåˆ†äº«æ— èŠçš„æ—¥å¸¸çäº‹å—ï¼Ÿ", options: [{ text: "ç»å¸¸ï¼Œçœ‹åˆ°ä¸€åªçŒ«éƒ½ä¼šæ‹ç»™ä½ ", score: 10 }, { text: "å¶å°”ä¼šåˆ†äº«", score: 6 }, { text: "åªæœ‰è¿™ç§äº‹æ‰æ‰¾ä½ ", score: 8 }, { text: "åŸºæœ¬ä¸åˆ†äº«ï¼ŒåªèŠæ­£äº‹", score: 0 }] },
        { title: "19. èº«ä½“æ¥è§¦çš„ååº”ï¼ˆPersonal Spaceï¼‰ï¼Ÿ", options: [{ text: "ä¸æ’æ–¥ï¼Œç”šè‡³ä¼šå€Ÿæœºæ›´é è¿‘", score: 10 }, { text: "æœ‰ç‚¹åƒµç¡¬ï¼Œä½†æ²¡æœ‰èº²å¼€", score: 6 }, { text: "ä¸‹æ„è¯†åé€€æˆ–é¿å¼€", score: 0 }, { text: "ä¿æŒç¤¼è²Œçš„ç¤¾äº¤è·ç¦»", score: 2 }] },
        { title: "20. å½“ä½ å¦‚æœä¸å›æ¶ˆæ¯ï¼ŒTAä¼šï¼Ÿ", options: [{ text: "è¿‡ä¸€ä¼šå†å‘ä¸€æ¡ï¼Œæˆ–è€…æ‰“ç”µè¯", score: 10 }, { text: "è™½ç„¶ä¸å‘ï¼Œä½†èƒ½æ„Ÿè§‰åˆ°TAåœ¨ç­‰ä½ ", score: 6 }, { text: "ä½ ä¸å›ï¼ŒTAä¹Ÿç»å¯¹ä¸å›ï¼ˆåšå¼ˆï¼‰", score: 2 }, { text: "æ ¹æœ¬æ²¡å‘ç°ä½ æ²¡å›", score: 0 }] },
        { title: "21. å€Ÿä¸œè¥¿ç»™TAï¼ˆå¦‚å¤–å¥—/ä¹¦ï¼‰ï¼Œå½’è¿˜æ—¶ï¼Ÿ", options: [{ text: "æ´—å¾—å¾ˆå¹²å‡€ï¼Œç”šè‡³å¤¹äº†å°ç¤¼ç‰©/çº¸æ¡", score: 10 }, { text: "äº²è‡ªé€è¿˜ï¼Œå€ŸæœºèŠå‡ å¥", score: 8 }, { text: "å«ä¸ªè·‘è…¿æˆ–è€…æ”¾å‰å°", score: 0 }, { text: "å¿˜äº†è¿˜ï¼Œè¿˜å¾—ä½ å‚¬", score: 0 }] },
        { title: "22. è°ˆè®ºåˆ°æ„Ÿæƒ…è§‚æˆ–æ‹©å¶æ ‡å‡†æ—¶ï¼Ÿ", options: [{ text: "æè¿°çš„æ ‡å‡†è·Ÿä½ å¾ˆåƒ", score: 10 }, { text: "é—®ä½ å–œæ¬¢ä»€ä¹ˆæ ·çš„", score: 8 }, { text: "è¯´è‡ªå·±ä¸æƒ³è°ˆæ‹çˆ±", score: 0 }, { text: "å›é¿è¿™ä¸ªè¯é¢˜", score: 2 }] },
        { title: "23. ä½ ä»¬æœ‰è¿‡æ·±å¤œé•¿è°ˆå—ï¼Ÿ", options: [{ text: "æœ‰ï¼ŒèŠè¿‡å¾ˆå¤šç«¥å¹´ã€æ¢¦æƒ³ç­‰æ·±åº¦è¯é¢˜", score: 10 }, { text: "å¶å°”èŠå¾—æ¯”è¾ƒæ™šï¼Œä½†éƒ½æ˜¯é—²èŠ", score: 6 }, { text: "æ²¡æœ‰ï¼Œåˆ°ç‚¹å°±ç¡", score: 0 }, { text: "TAåªæœ‰æ·±å¤œæ‰æ‰¾ä½ ï¼ˆè­¦æƒ•ï¼‰", score: 2 }] },
        { title: "24. TAä¼šè®°å¾—ä½ çš„ç”Ÿç†æœŸ/å¿Œå£å—ï¼Ÿ", options: [{ text: "è®°å¾—å¾ˆæ¸…æ¥šï¼Œç‚¹èœæ—¶ä¼šé¿å¼€", score: 10 }, { text: "æé†’è¿‡ä¸€æ¬¡å°±è®°ä½äº†", score: 8 }, { text: "æ€»æ˜¯è®°ä¸ä½", score: 0 }, { text: "å®Œå…¨ä¸åœ¨æ„", score: 0 }] },
        { title: "25. æœ€åï¼Œç›¸ä¿¡ä½ çš„ç›´è§‰ï¼š", options: [{ text: "è™½ç„¶æ²¡æŒ‘æ˜ï¼Œä½†æˆ‘ç¡®å®šTAçœ¼é‡Œæœ‰æˆ‘", score: 10 }, { text: "èƒ½æ„Ÿè§‰åˆ°æµ…æµ…å–œæ¬¢ï¼Œä½†è¿˜æ²¡åˆ°é‚£ä¸€æ­¥", score: 6 }, { text: "æˆ‘ä¸ç¡®å®šï¼Œæ‚£å¾—æ‚£å¤±", score: 2 }, { text: "æ„Ÿè§‰ä¸åˆ°å–œæ¬¢ï¼Œç”šè‡³è§‰å¾—çƒ¦", score: 0 }] }
    ];

    // ================= æ ¸å¿ƒé€»è¾‘ =================
    var totalScore = 0;
    var userGender = "";
    var userStatus = "";
    var currentStep = 0;

    document.getElementById('q-total').innerText = questions.length;

    function goToGender() {
        var codeInput = document.getElementById('access-code');
        var code = codeInput.value.trim().toUpperCase(); 
        if(VALID_CODES.indexOf(code) !== -1) {
            document.getElementById('page-landing').classList.add('hidden');
            document.getElementById('page-gender').classList.remove('hidden');
        } else {
            alert("è§£é”ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥");
            codeInput.value = '';
        }
    }

    function selectGender(g) {
        userGender = g;
        document.getElementById('page-gender').classList.add('hidden');
        document.getElementById('page-status').classList.remove('hidden');
    }

    function selectStatus(s) {
        userStatus = s;
        document.getElementById('page-status').classList.add('hidden');
        document.getElementById('page-quiz').classList.remove('hidden');
        renderQuestion();
    }

    function renderQuestion() {
        if(currentStep >= questions.length) {
            finishTest();
            return;
        }
        var q = questions[currentStep];
        
        var percent = ((currentStep+1)/questions.length)*100 + "%";
        document.getElementById('progress').style.width = percent;
        document.getElementById('q-curr').innerText = currentStep + 1;
        document.getElementById('q-text').innerText = q.title;
        
        var labels = ["A", "B", "C", "D"];
        var html = '';
        for(var i=0; i<q.options.length; i++) {
            var opt = q.options[i];
            html += '<div class="option-btn" onclick="nextQ('+opt.score+')">' +
                    '<div class="opt-idx">'+labels[i]+'</div>' +
                    '<div class="opt-content">'+opt.text+'</div>' +
                    '</div>';
        }
        document.getElementById('options-box').innerHTML = html;
        
        var box = document.getElementById('quiz-box');
        box.classList.remove('fade-in');
        void box.offsetWidth; 
        box.classList.add('fade-in');
    }

    function nextQ(score) {
        totalScore += score;
        currentStep++;
        setTimeout(renderQuestion, 200);
    }

    // ================== åˆ†æè¿‡ç¨‹åŠ¨ç”»é€»è¾‘ ==================
    function finishTest() {
        document.getElementById('page-quiz').classList.add('hidden');
        document.getElementById('page-analyzing').classList.remove('hidden');
        runAnalysisSequence();
    }

    function runAnalysisSequence() {
        var logs = document.getElementById('log-container');
        var mainText = document.getElementById('analyze-main-text');
        var progressBar = document.getElementById('analyze-progress');
        
        var steps = [
            { text: "æ­£åœ¨å»ºç«‹å¿ƒåŠ¨è¿æ¥...", sub: "> CONNECTING TO HEART SIGNAL..." },
            { text: "æå–ç¬¬ 1-10 é¢˜è¡Œä¸ºæ¨¡å¼...", sub: "> EXTRACTING BEHAVIOR DATA..." },
            { text: "æ­£åœ¨è§£æå¾®è¡¨æƒ…ä¿¡å·...", sub: "> ANALYZING MICRO-EXPRESSIONS..." },
            { text: "æ¯”å¯¹æ‹çˆ±å¿ƒç†å­¦æ¨¡å‹...", sub: "> MATCHING PSYCHOLOGY DB..." }, // æ”¹å¾—ç¨å¾®ä¸“ä¸šåˆä¸æ­»æ¿
            { text: "æ’é™¤å¹²æ‰°é¡¹ï¼Œè®¡ç®—çœŸå®æ„å›¾...", sub: "> CALCULATING PROBABILITY..." },
            { text: "åˆ†æå®Œæˆï¼Œç”Ÿæˆè¯Šæ–­ä¹¦...", sub: "> REPORT GENERATED." }
        ];

        var duration = 4500; 
        var stepTime = duration / steps.length;
        
        progressBar.style.transition = `width ${duration}ms linear`;
        setTimeout(() => { progressBar.style.width = '100%'; }, 50);

        var currentStep = 0;
        var interval = setInterval(function() {
            if(currentStep >= steps.length) {
                clearInterval(interval);
                setTimeout(showResult, 500); 
                return;
            }

            mainText.innerText = steps[currentStep].text;

            var logHtml = `<div class="log-item active">${steps[currentStep].sub}</div>`;
            var oldLogs = logs.getElementsByClassName('log-item');
            if(oldLogs.length > 0) {
                oldLogs[oldLogs.length-1].classList.remove('active');
                oldLogs[oldLogs.length-1].classList.add('old');
            }
            logs.insertAdjacentHTML('beforeend', logHtml);
            logs.scrollTop = logs.scrollHeight;

            currentStep++;
        }, stepTime);
    }

    function showResult() {
        document.getElementById('page-analyzing').classList.add('hidden');
        document.getElementById('page-result').classList.remove('hidden');

        var finalPercent = Math.round((totalScore / 250) * 100);
        if(finalPercent > 100) finalPercent = 100;
        
        document.getElementById('final-score').innerText = finalPercent;

        var ctx = document.getElementById('scoreChart').getContext('2d');
        if(window.myChart instanceof Chart) window.myChart.destroy();

        window.myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [finalPercent, 100-finalPercent],
                    backgroundColor: ['#8483f0', '#e0e0e0'],
                    borderWidth: 0,
                    hoverBackgroundColor: ['#8483f0', '#e0e0e0']
                }]
            },
            options: { 
                cutout: '85%', 
                responsive: true, 
                maintainAspectRatio: false, 
                events: [],
                plugins: {
                    tooltip: { enabled: false },
                    legend: { display: false }
                },
                animation: { animateScale: true, animateRotate: true }
            }
        });

        // ç»“æœé€»è¾‘
        var title = "";
        var tag = "";
        var analysis = "";
        var advice = "";

        if(finalPercent >= 90) {
            title = "ç»å¯¹å æœ‰ (Obsessed)";
            tag = "ğŸ”’ çŒäººå·²å°±ä½";
            analysis = "åˆ«æ€€ç–‘äº†ï¼ç³»ç»Ÿç›‘æµ‹åˆ°ç¬¬2ã€5ã€19é¢˜çš„è¡Œä¸ºæ¨¡å¼åŒ¹é…åº¦é«˜è¾¾98%ã€‚TAçš„æ¯ä¸€ä¸ªâ€œæ¼«ä¸ç»å¿ƒâ€å…¶å®éƒ½æ˜¯ç²¾å¿ƒè®¾è®¡ã€‚çœ¼ç¥çš„é”å®šå’Œä¸»åŠ¨çš„é è¿‘ï¼ˆèº«ä½“è¯­è¨€ï¼‰ï¼Œéƒ½æ˜¯æ— æ³•æ©é¥°çš„è¯æ®ã€‚TAå¯¹ä½ çš„å æœ‰æ¬²å·²ç»åˆ»åœ¨æ½œæ„è¯†é‡Œäº†ã€‚";
            advice = "ä¸ç”¨å†è¯•æ¢äº†ï¼Œå¯ä»¥ç›´æ¥ç»™ä¸€ç‚¹æ˜æ˜¾çš„ä¿¡å·ï¼ˆæ¯”å¦‚è‚¢ä½“æ¥è§¦ï¼‰ï¼ŒTAä¼šç«‹åˆ»æ‰‘ä¸Šæ¥è¡¨ç™½ã€‚ç°åœ¨æ˜¯ä½ æŒæ¡ä¸»åŠ¨æƒçš„æœ€ä½³æ—¶æœºã€‚";
        } else if(finalPercent >= 70) {
            title = "åŒå‘é”å®š (Locked)";
            tag = "ğŸ’˜ åªå·®ä¸€å±‚çª—æˆ·çº¸";
            analysis = "æ­å–œï¼Œå¾®è¡¨æƒ…åˆ†ææ˜¾ç¤ºTAåœ¨æåˆ°ä½ æ—¶ç³å­”æœ‰æ˜æ˜¾çš„æ”¾å¤§ååº”ã€‚TAçš„çŠ¹è±«å’Œè¯•æ¢ï¼Œä¸æ˜¯å› ä¸ºä¸å–œæ¬¢ï¼Œè€Œæ˜¯å› ä¸ºå¤ªåœ¨ä¹ï¼Œæ€•è¯´é”™è¯ç ´åå…³ç³»ã€‚TAå·²ç»åœ¨å°å¿ƒç¿¼ç¿¼åœ°å‘ä½ é è¿‘äº†ã€‚";
            advice = "ç»™TAä¸€é¢—å®šå¿ƒä¸¸ã€‚æ‰¾ä¸ªæœºä¼šå•ç‹¬ç›¸å¤„ï¼Œç¨å¾®å¤¸å¤¸TAï¼Œæˆ–è€…åˆ¶é€ ä¸€ç‚¹æš§æ˜§çš„æ°›å›´ï¼Œè¿™å±‚çª—æˆ·çº¸ä¸€æ…å°±ç ´ã€‚";
        } else if(finalPercent >= 45) {
            title = "æƒè¡¡åˆ©å¼Š (Game)";
            tag = "âš–ï¸ ç©å®¶å¿ƒæ€";
            analysis = "TAå¯¹ä½ æœ‰å¥½æ„Ÿï¼Œä½†è¿™å¥½æ„Ÿè¿˜ä¸è¶³ä»¥è®©TAå†²åŠ¨ã€‚ç³»ç»Ÿåˆ¤æ–­TAå±äºâ€œä½æŠ•å…¥é«˜å›æŠ¥â€å‹äººæ ¼ï¼Œæ­£åœ¨æƒè¡¡åˆ©å¼Šï¼Œæˆ–è€…åŒæ—¶åœ¨å¯¹æ¯”å…¶ä»–äººã€‚ç°åœ¨çš„TAå°±åƒä¸€ä¸ªå†·é™çš„æ£‹æ‰‹ï¼Œè¿›é€€è‡ªå¦‚ã€‚";
            advice = "åƒä¸‡ä¸è¦æ€¥ç€è¡¨ç™½ï¼ç°åœ¨è¡¨ç™½ä½ å°±è¾“äº†ã€‚ä½ éœ€è¦â€œåæ’¤â€ï¼Œä¸“æ³¨è‡ªå·±çš„ç”Ÿæ´»ï¼Œå±•ç°é«˜ä»·å€¼ï¼Œè®©TAäº§ç”Ÿå±æœºæ„Ÿï¼ŒTAæ‰ä¼šä¸»åŠ¨å‡ºå‡»ã€‚";
        } else {
            title = "æ·±æµ·é±¼è‹— (Fish)";
            tag = "ğŸŸ ç¤¼è²Œæ€§ç¤¾äº¤";
            analysis = "å¾ˆæ‰å¿ƒï¼Œä½†è¡Œä¸ºæ•°æ®æ˜¾ç¤ºï¼Œä½ å¤§æ¦‚ç‡åªæ˜¯TAé±¼å¡˜é‡Œçš„ä¸€æ¡é±¼ã€‚TAå¯¹ä½ çš„æ‰€æœ‰å›åº”ï¼Œç¬¦åˆâ€œç¤¼è²Œæ€§ç¤¾äº¤â€ç‰¹å¾ã€‚TAçš„æ½œæ„è¯†é‡Œï¼Œå¹¶æ²¡æœ‰æŠŠä½ å½“ä½œçŒç‰©ï¼Œä¹Ÿæ²¡æœ‰é‚£ç§â€œéä½ ä¸å¯â€çš„å†²åŠ¨ã€‚";
            advice = "åŠæ—¶æ­¢æŸæ˜¯æœ€é«˜çº§çš„è‡ªå¾‹ã€‚åœæ­¢ä¸»åŠ¨æ‰¾TAï¼ŒæŠŠæ³¨æ„åŠ›æ”¾å›è‡ªå·±èº«ä¸Šã€‚å¦‚æœTAä¸æ‰¾ä½ ï¼Œé‚£å°±ä¸‹ä¸€ä¸ªæ›´ä¹–ã€‚";
        }

        document.getElementById('res-title').innerText = title;
        document.getElementById('res-tag').innerText = tag;
        document.getElementById('res-analysis').innerText = analysis;
        document.getElementById('res-advice').innerText = advice;
    }
</script>
</body>
</html>
